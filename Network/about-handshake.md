# handshake

## SSL 핸드셰이크 sslHandshake
- SSL/TLS 프로토콜에서 클라이언트와 서버 간의 보안 연결을 설정하는 과정
- 보안 소켓 연결을 수립하는 과정으로, 클라이언트와 서버가 서로 신뢰할 수 있는 통신 채널을 구축하도록 함

#### 주요 단계
1. 연결 요청: 클라이언트 -> 서버 연결 요청 및 수락
2. 서로의 신원 확인: 클라이언트와 서버는 서로의 신원을 확인하기 위해 서로의 인증서를 교환
3. 공개키 암호화: 클라이언트는 서버의 공개키를 사용하여 랜덤한 대칭키를 암호화하여 서버에게 전송
4. 세션 키 교환: 서버는 클라이언트로부터 받은 암호화된 대칭키를 자신의 개인키로 복호화하여 세션 키 획득 후, 통신에서 데이터 암복호화에 사용
5. 연결 보안 파라미터 협상: 클라이언트와 서버는 연결에 대한 암호화 알고리즘, 압축 방법, 세션 유효성 등의 보안 파라미터를 협상하여 상호간에 동의된 보안 설정을 사용하여 통신
6. 핸드셰이크 완료: 핸드셰이크 과정이 완료되고 안전한 SSL/TLS 연결이 맺어지면 이후 통신은 암호화 되어 보호됨


## 3-way handshake
- TCP/IP 프로토콜에서 클라이언트와 서버 간에 연결을 수립하는 과정
- SSL이 초기에 넷스케이프에서 개발된 후 IETF에서 SSL의 후속 버전인 TLS 개발
- 현재는 SSL과 TLS는 서로 호환되는 개념으로 취급하며, 일반적으로 SSL이라는 용어로 사용

#### 주요 단계
1. SYN (Synchronize) 요청: 클라이언트가 서버에게 연결을 요청하기 위한 SYN 패킷 전송
    - SYN 패킷에는 클라이언트가 선택한 임의의 숫자인 초기 순서 번호가 포함됨(ISN, Initial Sequence Number)
    - 초기 순서 번호는 클라이언트가 서버와의 통신에서 사용할 순서 번호의 시작점을 나타내는 숫자
2. SYN-ACK (Synchronize-Acknowledge) 응답: 서버가 SYN 패킷을 받으면 연결 요청을 수락한다는 의미로 ACK와 SYN 패킷을 함께 전송.
    - 이 때 ACK에는 클라이언트의 초기 순서 번호에 1을 더한 값이 포함됨
    - 서버도 자신이 사용할 초기 순서 번호를 선택하여 SYN 패킷에 포함시킴
3. ACK (Acknowledgement) 확인 응답: 클라이언트는 서버로부터의 SYN-AKC 패킷을 받고 연결 요청을 수락한다는 의미로 서버에 ACK 패킷을 전송.
    - 이 때 ACK에는 서버의 초기 순서 번호에 1을 더한 값이 포함됨
